{% set cfg = {'result': False} %}
{% set _ = cfg.__setitem__('result', neofs_ir__default_config) %}

{% for part in neofs_ir__combined_config %}
{%   if part.replace | d(False) %}
{%     set o = part.options %}
{%   else %}
{%     if 'path' in part %}
{%       set o = cfg.result[part.path] | combine( part.options, recursive=True, list_merge='append' ) %}
{%     else %}
{%       set o = cfg.result | combine( part.options, recursive=True, list_merge='append' ) %}
{%     endif %}
{%   endif %}
{%   if 'path' in part %}
{%     set _ = cfg.result.__setitem__(part.path, o) %}
{%   else %}
{%     set _ = cfg.__setitem__('result', o) %}
{%   endif %}
{% endfor %}

{{ ansible_managed | comment }}

{{ cfg.result | to_nice_yaml(indent=2) }}
